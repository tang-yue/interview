计算机网络

### TCP/IP 协议 分层

1. 链接层   --- mac 层
2. 网际层   --- IP 协议
3. 传输层   --- TCP/UDP协议
4. 应用层   --- HTTP 协议

参考 透视http协议

### http 3次握手

客户端发起连接请求 =》服务器确认连接请求 =》客户端确认收到确认连接请求 =》服务器等待接收请求，客户端发送请求

## TCP 三次握手 和 四次挥手

客户端发起连接请求=》服务器确认连接请求=》客户端确认收到确认连接请求=》服务器等待接收请求、客户端发送请求

建立连接--三次握手

1. 主机向服务器发送一个建立连接的请求 （您好，我想认识您）
2. 服务器接到请求后发送同意连接的信号  （好的，很高兴认识您）
3. 主机接到同意连接的信号后，再次向服务器发送了确认信号（我也很高兴认识您），自此，主机与服务器两者建立了连接。

说明：
采用tcp协议，保证信息传输的可靠性，三次握手过程中，若一方收不到确认信号，协议会要求重新发送信号。

断开连接--四次挥手

客户端发送结束请求FIN =》服务器确认收到FIN请求 =》服务器发送结束返回FIN =》客户端确认收到FIN返回，断开TCP连接

1. 主机向服务器发送一个断开连接的请求 （不早了，我该走了）
2. 服务器接到请求后发送确认收到请求的信号（知道了）
3. 服务器向主机发送断开通知（我也该走了）
4. 主机接到断开通知后断开连接并反馈一个确认信号（嗯，好的），服务器收到确认信号后断开连接。

### 什么是cdn

CDN，全称是“Content Delivery Network”，翻译过来就是”内容分发网络“

CDN的工作原理就是将您源站的资源缓存到位于全球各地的CDN节点上，用户请求资源时，就近返回节点上缓存的资源，而不需要每个用户的请求都回您的源站获取，避免网络拥塞、缓解源站压力，保证用户访问资源的速度和体验。


### http的方法有哪几种，每种方法的用途

+ GET: 获取资源
+ POST: 提交数据、添加资源
+ HEAD: 获取报头
+ OPTIONS: 预检请求，用来获取受支持的方法
- 可能对服务器数据产生副作用的HTTP请求，如 put，delete 都会对服务器数据进行修改，所以要先询问服务器
+ PUT/PATCH: 更新资源，PUT 全更新，PATCH部分更新
+ DELETE: 删除资源
+ TRACE: 回显服务器收到的请求，用于测试或诊断

### http 状态码

+ 1xx：提示信息，表示目前是协议处理的中间状态，还需要后续的操作；
+ 2xx：成功，报文已经收到并被正确处理；
+ 3xx：重定向，资源位置发生变动，需要客户端重新发送请求； 
+ 4xx：客户端错误，请求报文有误，服务器无法处理；
+ 5xx：服务器错误，服务器在处理请求时内部发生了错误；

### http1.0 和 http1.1 以及 http2.0 区别

#### http1.0 和 http1.1 区别

- 长连接
   + 在HTTP 0.9 和 1.0 中， TCP连线在每一次请求/回应对之后关闭。在HTTP1.1中，引入了保持连线的机制，一个连接可以重复在多个请求/回应使用，持续连线的方式可以大大减少等待时间。
- 同一个ip 和 端口 提供不同的服务
- 带宽
   + HTTP 管道允许客户端在收到每个回应之前发送多个请求，进一步减少用户感受到的滞后时间

#### http1.x 和 http2.0 的区别

- 多路复用
   + http1.x 建立多个tcp连接，导致的阻塞问题，HTTP2让所有的通信都在一个TCP连接上完成，实现了请求的并发。
- 头部压缩
   + http1.x 采用的是文本格式，而http2是二进制，客户端和服务器端维护着字典，根据一定规则。
-  服务器端推送
   + http1.x 客户端不能主动向服务端发起请求，而 http2.0 的服务器推送使得服务器可以预测客户端需要的资源，主动推送到客户端。

### 谈谈多路复用

一个连接上面可以有任意多个流，消息分割成一个或多个帧在流里面传输，帧传输过去以后，在进行重组，形成一个完整的请求或响应。如果请求太多，流控制会管理数据的传输，允许接收者停止或减少发送的数据量，免得接收方不堪重负。

[参考资料](https://juejin.im/post/6844903734670000142)

[参考资料](https://juejin.im/entry/6844903745768161287)

### https的作用，工作原理

https 相对于http 有如下作用：

- 机密性：只能由可信的人访问，对其他人不可见
- 认证通信方的身份
- 数据完整性校验
- 不可否认，不能否认发生过的行为

HTTPS 相当于“HTTP + SSL/TLS + TCP/IP”

TCP 位于IP协议之上，基于IP协议提供可靠的，字节流形式的通信，“可靠”保证数据不丢失，“字节流”保证数据完整。

一次完整的https 交流

- 客户端通过TCP三次握手建立到服务器端口443的TCP连接
- 客户端通过SSL握手建立安全层
- 客户端发送http报文到SSL安全层，安全层将报文加密后发送给TCP ---> IP ---> mac层
- 同理服务器发送响应，客户端接收后通过SSL安全层解密发给应用层
- SSL 安全层关闭通知
- TCP 关闭连接

https 图：
```js
HTTP        应用层
SSL or TSL  安全层
TCP         传输层
IP          网络层
网络接口     数据链路层
双绞铜线     物理层
```

我觉得上述才是工作原理，包括了，三次握手，ssl握手，和四次挥手

[参考文章](https://juejin.im/post/6844903623613218824)

### udp 和 tcp 的区别

+ 发送数据前不需要建立连接
- tcp需要先与对方建立连接然后才能发送数据，而且保证数据不丢失不重复，而udp不需要建立连接可以任意发送数据，但不保证数据一定会发到对方。
+ 不需要验证数据报文
+ 传输的数据形式不同
- TCP的数据是连续的“字节流”，有先后顺序，而UDP则是分散的小数据包，是顺序发，乱序收。

### 状态码 301 和 302 的区别

301: 永久重定向；被请求的资源已永久移动到新位置， 301 浏览器会默认给一个很长的缓存。

302: 临时重定向；请求的资源现在临时从不同的URI响应请求，由于这样的重定向是临时的，客户端应当继续向原有地址发送以后的请求。
只有在Cache-Control或Expires中进行了指定的情况下，这个响应才是可缓存。

[参考文章](https://juejin.im/post/6844904097733165069)

### ssl 握手

概念：SSL/TLS 负责加密通信的安全协议，建立在TCP/IP 之上，SSL 由网景公司发明，当发展到3.0时，被标准化，改名为TLS.

1. 第一步：客户端给出协议版本号，一个客户端生成的随机数（Client random），以及客户端支持的加密的方法
2. 第二步：服务器确认双方使用的加密方法，并给出数字证书、以及一个服务器生成的随机数 (Server random)
3. 第三步：客户端确认数字证书有效，然后生成一个新的随机数 (Premaster secret)，并使用数字证书中的公钥，加密这个随机数，发给服务端
4. 第四步：服务端使用自己的私钥，解密刚刚被客户端加密的随机数
5. 第五步：客户端和服务器端根据约定的加密方法，使用前面的三个随机数，生成“对话密钥”，用来加密接下来的整个对话过程

[参考文章](http://www.ruanyifeng.com/blog/2014/09/illustration-ssl.html)

[参考文章](https://juejin.im/post/6856595606677716999)

### https 如何保证证书是可信任的

证书是一个站点的身份证，但是身份证也可以被伪造，为了保证这个证书是真的我们需要数字签名。我们会将
证书内容用签名算法生成一个值，我们称之为“摘要”。然后将该摘要用主机的私钥加密，加密后的内容就是我们的数字签名。

当客户端收到附带数字签名的数字证书时，会通过数字证书中的证书签名算法将该证书生成一个摘要，在用服务器众所周知的
公钥解密数字签名，看得到的摘要是否相同，相同那就说明证书是真的。

[参考文章](https://juejin.im/post/6844903623613218824)
